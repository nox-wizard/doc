<HTML>
<HEAD>
<TITLE> Default arguments in functions </TITLE>
<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
</HEAD>
<BODY leftmargin="0" rightmargin="0"  topmargin="0" marginwidth="0" marginheight="0">
<TABLE WIDTH="100%" HEIGHT="100%" BORDER="0" cellpadding="0" cellspacing="0" >
	<TR HEIGHT=75 bgcolor=#125492> 
		<TD>
			<image src="logo.gif" >
			<font color="#FFFFFF" size="5" face="ArialBlack">
			version 0.82
			</FONT>
		</TD> 
	</TR>
	<TR HEIGHT=1 bgcolor=#808080><TD></TD></TR>
	<TR HEIGHT=1 bgcolor=#D4D0C8><TD></TD></TR>
	<TR HEIGHT=5 bgcolor=#FFFFFF><TD></TD></TR>
	<TR BGCOLOR=#FFFFFF ALIGN="left"> <TD VALIGN="top">
		<TABLE WIDTH=100% cellpadding="0" cellspacing="0">
			<TR>
				<TD WIDTH=30  VALIGN=top >
					<TABLE WIDTH=30 cellpadding="0" cellspacing="0">
						<TR HEIGHT=26 bgcolor=#FFFFFF><TD></TD></TR>
						<TR HEIGHT=1 bgcolor=#808080><TD></TD></TR>
						<TR HEIGHT=1 bgcolor=#D4D0C8><TD></TD></TR>
						<TR><TD></TD></TR>
					</TABLE>
				</TD>
				<TD>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1><a class="anchor" name="p_default_arguments">Default arguments in functions</a></h1>Sometimes there is the need of a function wich can be passed a variable number of arguments, a typical example is<p>
<pre class="fragment"><div>        <a class="code" href="group__script__API__character.html#ga3">chr_getProperty</a>(chr,prop,subprop);
        <a class="code" href="group__script__API__character.html#ga3">chr_getProperty</a>(chr,prop);
</div></pre><p>
in this example <a class="el" href="group__script__API__character.html#ga3">chr_getProperty()</a> is called firstly with 3 arguments and then with only 2.<br>
 This is because <a class="el" href="group__script__API__character.html#ga3">chr_getProperty()</a> is declared with default arguments<p>
<pre class="fragment"><div>        <a class="code" href="group__script__API__character.html#ga3">chr_getProperty</a>(cont chr, <span class="keyword">const</span> prop, <span class="keyword">const</span> subprop = 0, ...);
</div></pre><p>
this declaration says that if the subpropargument is not specified then 0 will be assumed as the value.<br>
 The ellipsis (...) says that the number of argments is not fixed, but can vary,so the following function call<p>
<pre class="fragment"><div>        <a class="code" href="group__script__API__character.html#ga3">chr_getProperty</a>(chr,prop,subprop,a,b,c,d,e,f);
</div></pre><p>
is correct,this does not mean it will do anything useful, but it's not an error.<br>
 <br>
 Having function declared in such a way is sometimes useful if you don't want to write 2 functions that do the same thing with a different number of arguments, let'smake an example.<br>
 Suppose you want a functionthat takes a flag as an argument <pre class="fragment"><div>        stealGoldFromAllPlayersBankAndPutInMine(<span class="keyword">const</span> chr, <span class="keyword">const</span> onlyGold)
</div></pre>this function will transfer all gold from all players' bank to the specified character's bank, if onlyGold is 1 then only the gp will be transferred, else all the bank content will be taken.<br>
 Usually this function will be called as <pre class="fragment"><div>        stealGoldFromAllPlayersBankAndPutInMine(chr,0)
</div></pre>so you may want to declare it like <pre class="fragment"><div>        stealGoldFromAllPlayersBankAndPutInMine(<span class="keyword">const</span> chr, <span class="keyword">const</span> onlyGold = 0)
</div></pre>so you can call it with <pre class="fragment"><div>        stealGoldFromAllPlayersBankAndPutInMine(chr)
</div></pre>and have the same result.<br>
 If you try this, you will get a compiler error saying that public functions can't have default arguments.<br>
 In Small only native functions can have default arguments, so it seems we have to forget about doing functions with default arguments ...<h2><a class="anchor" name="getargsnumargs">
numargs() and getarg()</a></h2>
I'm sure only a few people know the correct use of the ellipsis (...) and <a class="el" href="core_8api.html#a2">numargs()</a> and <a class="el" href="core_8api.html#a3">getarg()</a> functions, so I'mgoing to explain them.<br>
 As mentioned above the ellipsis allows a function to take a variable number of arguments so with the decalration<p>
<pre class="fragment"><div>        <span class="keyword">public</span> testEllipsis(...)
</div></pre><p>
all this function calls are correct<p>
<pre class="fragment"><div>        testEllipsis()
        testEllipsis(a)
        testEllipsis(a,b)
        testEllipsis(a,b,c)
        testEllipsis(a,b,c,d)
        testEllipsis(a,b,c,d,e)
</div></pre><p>
The problem is that when you write the function body you have no idea of how many parameters will be passed to the function, so you need a way to know how many parameters have been passed.<br>
 You can sothis with <a class="el" href="core_8api.html#a2">numargs()</a> and <a class="el" href="core_8api.html#a3">getarg()</a> functions:<ul>
<li><a class="el" href="core_8api.html#a2">numargs()</a> returns the number of valid arguments passed to the function</li><li>getarg(n) returns the value of the n-th parameter (0 based, so fisrt parameter is getarg(0))</li></ul>
<p>
with these functions you can know what you need to write the function body.<br>
<h2><a class="anchor" name="defaultargumentsinpublicfunctions">
Default arguments in public functions</a></h2>
Let's see how we can useellipsis to imlement default arguments in public Small functions.<br>
 First of all declare a function where the arguments you want to have a default value are replaced with ellipsis, so if you want <pre class="fragment"><div>        <span class="keyword">public</span> testDefaults(a,b,c = 5, d = 7, e = 9)
</div></pre><p>
declare it like<p>
<pre class="fragment"><div>        <span class="keyword">public</span> testDefaults(a,b,...)
</div></pre><p>
then with <a class="el" href="core_8api.html#a2">numargs()</a> and <a class="el" href="core_8api.html#a3">getarg()</a> you can implement default values as follows <pre class="fragment"><div>        <span class="keyword">public</span> testDefaults(a,b,...)
        {
                <span class="keyword">new</span> c = 5,d = 7,e = 9;
                <span class="keyword">new</span> n = <a class="code" href="core_8api.html#a2">numargs</a>();
                
                <span class="keywordflow">if</span>(n &gt; 2)
                        c = <a class="code" href="core_8api.html#a3">getarg</a>(2);
                
                <span class="keywordflow">if</span>(n &gt; 3)
                        d = <a class="code" href="core_8api.html#a3">getarg</a>(3);
                        
                <span class="keywordflow">if</span>(n &gt; 4)
                        e = <a class="code" href="core_8api.html#a3">getarg</a>(4);
                
                <span class="comment">/*</span>
<span class="comment">                rest of function</span>
<span class="comment">                */</span>
        }
</div></pre><p>
What have we done? At the beginning of the function we read the number of arguments and assigned all additional arguments to some variables, so after the parameter-reading code we can write our function as if it was daclared with default arguments.<br>
 Not that you can only put the ellipsis (...) to replace last parameters, so this decalration<p>
<pre class="fragment"><div>        <span class="keyword">public</span> testDefaults(...,c,d,e)
</div></pre><p>
is wrong.<br>
 Additionally when you call a function declared with variable arguments, your additional arguments will be read left to right, in our example if you call the function with <pre class="fragment"><div>        testDefaults(x,y,z,t)
</div></pre>then z will be assigned to c and t to d.<br>
 Now let's finish our function so we can test it<p>
<pre class="fragment"><div><span class="keyword">public</span> testDefaults(a,b,...)
        {
                <span class="keyword">new</span> c = 5,d = 7,e = 9;
                <span class="keyword">new</span> n = <a class="code" href="core_8api.html#a2">numargs</a>();
                
                <span class="keywordflow">if</span>(n &gt; 2)
                        c = <a class="code" href="core_8api.html#a3">getarg</a>(2);
                
                <span class="keywordflow">if</span>(n &gt; 3)
                        d = <a class="code" href="core_8api.html#a3">getarg</a>(3);
                        
                <span class="keywordflow">if</span>(n &gt; 4)
                        e = <a class="code" href="core_8api.html#a3">getarg</a>(4);
                
                <a class="code" href="core_8api.html#a19">printf</a>(<span class="stringliteral">"Function called with %d arguments, arguments are:^n"</span>)
                <span class="keywordflow">for</span>(<span class="keyword">new</span> i = 0; i &lt; n; i++)
                        <a class="code" href="core_8api.html#a19">printf</a>(<span class="stringliteral">"%d^n"</span>,<a class="code" href="core_8api.html#a3">getarg</a>(i));
        }
</div></pre><p>
I agree that's not such a useful function,but it's good to see how default parameters work, enjoy! 				</TD>
				<TD WIDTH=30  VALIGN=top >
					<TABLE WIDTH=30 cellpadding="0" cellspacing="0">
						<TR HEIGHT=26 bgcolor=#FFFFFF><TD></TD></TR>
						<TR HEIGHT=1 bgcolor=#808080><TD></TD></TR>
						<TR HEIGHT=1 bgcolor=#D4D0C8><TD></TD></TR>
						<TR><TD></TD></TR>
					</TABLE>
				</TD>
			</TR>
		</TABLE>
		</TD> 
	</TR>
	<TR HEIGHT=5 bgcolor=#FFFFFF><TD></TD></TR>
	<TR HEIGHT=1 bgcolor=#D4D0C8><TD></TD></TR>
	<TR HEIGHT=1 bgcolor=#808080><TD></TD></TR>
	<TR HEIGHT=75 bgcolor=#125492 ALIGN=right> <TD>
		<font color="#FFFFFF" size="4" face="ArialBlack">
			Documentation generated 29 May 2004 &nbsp&nbsp
		</FONT>
	</TD> 
	</TR>
</TABLE>
</BODY>
</HTML>

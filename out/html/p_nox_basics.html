<HTML>
<HEAD>
<TITLE> NOX basics </TITLE>
<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
</HEAD>
<BODY leftmargin="0" rightmargin="0"  topmargin="0" marginwidth="0" marginheight="0">
<TABLE WIDTH="100%" HEIGHT="100%" BORDER="0" cellpadding="0" cellspacing="0" >
	<TR HEIGHT=75 bgcolor=#125492> 
		<TD>
			<image src="logo.gif" >
			<font color="#FFFFFF" size="5" face="ArialBlack">
			version 0.82
			</FONT>
		</TD> 
	</TR>
	<TR HEIGHT=1 bgcolor=#808080><TD></TD></TR>
	<TR HEIGHT=1 bgcolor=#D4D0C8><TD></TD></TR>
	<TR HEIGHT=5 bgcolor=#FFFFFF><TD></TD></TR>
	<TR BGCOLOR=#FFFFFF ALIGN="left"> <TD VALIGN="top">
		<TABLE WIDTH=100% cellpadding="0" cellspacing="0">
			<TR>
				<TD WIDTH=30  VALIGN=top >
					<TABLE WIDTH=30 cellpadding="0" cellspacing="0">
						<TR HEIGHT=26 bgcolor=#FFFFFF><TD></TD></TR>
						<TR HEIGHT=1 bgcolor=#808080><TD></TD></TR>
						<TR HEIGHT=1 bgcolor=#D4D0C8><TD></TD></TR>
						<TR><TD></TD></TR>
					</TABLE>
				</TD>
				<TD>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1><a class="anchor" name="p_nox_basics">NOX basics</a></h1>NOX wizard bases his scripting capabilities on Small, a C derived language.<br>
 I won't explain all good features of Small (wich you can find on <a href="http://www.compuphase.com/small.htm">Small homepage</a>), Here you will find s rought description of how NOX works and how scripts interact with the source code.<br>
<h2><a class="anchor" name="thesourcecode">
The source code</a></h2>
NOX wizard is written in C++, all C++ parts are "the source code", these parts are compiled and put into a binary file.<br>
 Although NOX wizard is an open source project (so you can download the C++ code an modify it to your needs) modifyng the source code it's not the right way to cusomize the emulator, as source code changes over NOX versions and you might not be able to follow the evolution, of course you are free to take a stable version's code and make your own NOX wizard without caring of new versions, by this is not how NOX is intended to be used.<br>
 Assuming you don't want to have to do with sources, you are in the need to modify the emulator's behaviour without touching the source code.<br>
 How can I modify a program's behaviour if I can't access sources? Small language permits this, you can modify the internal emulator behaviour without having to do with sources.<br>
<h2><a class="anchor" name="thescriptinglanguage">
The scripting language</a></h2>
Small is the answer to the question we mentioned above! Although Small is not a programming language, it allows you to implement all the algorithms a normal language does, so once we can make the bynaries execute a Small routine, we can do what we want.<br>
 NOX has an embedded Small compiler, and at the startup all Small scripts are compiled and transformed in AMX code (you can see it in override.amx), this code, can be executed by a virtual machine coded in the sources, so once we have the AMX code, the exe can execute it as if it was source code.<br>
 <br>
 Let's explain a bit better for those who didn't catch the mechanism.<br>
 Source code is compiled into binary code wich can be executed by your computer's processor, NOX has an internal "processor" (the virtual machine) that can execute another binary code (AMX code), so NOX is for AMX code what your computer processor is for binary code, that is, AMX code can be executed by NOX, so we can write routines in AMX and they will be executed by NOX.<br>
 The good thing is that we can easily write AMX code from Small! At startup NOX compiles the Small scripts and transforms them into AMX code that can be executed! So with Small we can write "scripts": programs that can be executed by NOX.<br>
 <br>
 Now that we know how Small can be executed by NOX,it's time to learn how can we tell NOX to execute a Small routine.<br>
 Here come the only limitation of NOX scripting, we can only execute Small code when NOX allows us, we are not free to execute Small routines when we want, but we must have source code's permission to do that: we aren't saying to sources "Hey! I want to execute this, stop and do what I want" but the sources will say "Hey! if you want now you can perform something".<br>
 Luckily NOX allows a great number of locations in his source code where we can insert our custom scripts, so actually this limitation doesn't exist, moreover we must say that if you feel NOX doesn't have a feature you need, you can tell this to the dev team, and it will be added if possible.<br>
 A more detailed description on this argument can be found in the <a class="el" href="p_override.html">Overrides,events and callbacks</a> page.<br>
 For now all you have to know is that Small scripts are CALLED by sources when something special happens (server startup, character login, character death, skill use ...)<h2><a class="anchor" name="theAPIs">
The APIs</a></h2>
Now we know how NOX can execute our scripts and when, but another question rises: how can Small scripts support all the UO features and allow us to make script managing characters, items and so on?<br>
 Of course Small language wasn't written for UO scripting only, it's a general purpose language and in it's standard version it can't do many things but basic algorithms.<br>
 As a scripting language, Small heavily relies on the main program interface, so Small is powerful only if the hosting application (NOX) allows it to be powerful by giving appropriate funcitons to handle the source code data.<br>
 As source code is C++, an Object Oriented Language (OOL), is easy for the developers to give to Small the capabilities to interact with the program's objects and data types, doing this, Small becomes similar to an OOL itself, and it can deal with characters, items, NPCs, spells viewing them as objects.<br>
 The interface between the source code data and Small are the APIs (Application Programming Interface) wich are Small native functions (native = implemented in the sources) wich give the possibility to handle the internal data types an classes.<br>
 APIs are declared in the .api files (this extention does not imply anything particular, it's only to identify them, .api = .txt). You will see there are tons of APIs, this is because NOX really gives you control over every aspect of the source code, thus many of the internal functions are duplicated as APIs and made available to the scripter.<br>
 From the scrpter's point of view APIs are only a huge library of functions.<br>
 This way when a Small script is called by the sources it has quite the same computational power as the source code.<br>
 <br>
 Here comes the difficulty when we are talking about NOX scripting: altough Small is a simple language, the API library is so big that you will actually spend much more time in learning the APIs than in learning Small<br>
<h2><a class="anchor" name="thestandardscripts">
The standard scripts</a></h2>
Having an emulator with such a powerful scripting language is useless is you hadn't a standard script basis to work on.<br>
 Older NOX versions had very few Small scripts in the package (wich consisted only in the executable and the API library) so shard scripters had to do a lot of work if they wanted to implement custom features in their shard because they had to script everything from scratch.<br>
 NOX 0.82 (and all subsequent versions) ships with quite a large amount of predefined Small scripts that serve as a basis for scripters to customize their shard.<br>
 In the standard scripts you can find many emulator parts that in older versions were source coded and now are available as scripts (commands, skills, guild support ...) this means that if you want to modify a skill you don't have to script is by scratch but you can start modifying the standard scripts, and this saves many hours (days?) of try-and-error scripting.<br>
 				</TD>
				<TD WIDTH=30  VALIGN=top >
					<TABLE WIDTH=30 cellpadding="0" cellspacing="0">
						<TR HEIGHT=26 bgcolor=#FFFFFF><TD></TD></TR>
						<TR HEIGHT=1 bgcolor=#808080><TD></TD></TR>
						<TR HEIGHT=1 bgcolor=#D4D0C8><TD></TD></TR>
						<TR><TD></TD></TR>
					</TABLE>
				</TD>
			</TR>
		</TABLE>
		</TD> 
	</TR>
	<TR HEIGHT=5 bgcolor=#FFFFFF><TD></TD></TR>
	<TR HEIGHT=1 bgcolor=#D4D0C8><TD></TD></TR>
	<TR HEIGHT=1 bgcolor=#808080><TD></TD></TR>
	<TR HEIGHT=75 bgcolor=#125492 ALIGN=right> <TD>
		<font color="#FFFFFF" size="4" face="ArialBlack">
			Documentation generated 29 May 2004 &nbsp&nbsp
		</FONT>
	</TD> 
	</TR>
</TABLE>
</BODY>
</HTML>
